---
layout: post
title: ç»“åˆlibrecæºä»£ç è¯»è®ºæ–‡:ç»“åˆSocialä¿¡æ¯çš„ç›¸å…³æ¨¡å‹
author: Danyang Liu
---

æœ¬æ–‡ç»“åˆlibrecæºä»£ç ï¼Œæ€»ç»“ä¸€äº›ç»“åˆSocialä¿¡æ¯çš„ç›¸å…³æ¨èç³»ç»Ÿæ¨¡å‹


### TrustMFRecommender

å‚è€ƒè®ºæ–‡:[Yang B, Lei Y, Liu J, et al. Social collaborative filtering by trust[J]//IJCAI 2013.
](http://www.aaai.org/ocs/index.php/IJCAI/IJCAI13/paper/download/6750/7139)

CFæ–¹æ³•æ˜¯æ¨èç³»ç»Ÿéå¸¸æµè¡Œçš„æ–¹æ³•ï¼Œä½†æ˜¯å®ƒæœ‰æ•°æ®ç¨€ç–å’Œå†·å¯åŠ¨é—®é¢˜ï¼Œè¿™ç¯‡æ–‡ç« ç²¾å·§çš„ç»“åˆäº†ä¸¤ä¸ªç¨€ç–æ•°æ®æºï¼š
ç”¨æˆ·è¯„åˆ†çŸ©é˜µï¼Œå’Œä¿¡ä»»ç½‘ç»œï¼ˆtrust networkï¼‰ã€‚

è¿™ç¯‡æ–‡ç« æ€æƒ³æºäºï¼Œç”¨æˆ·åœ¨ç¤¾äº¤ç½‘ç»œä¸­çš„å½±å“æ˜¯ç›¸äº’çš„ï¼Œæ¯”å¦‚ç‰¹å®šç”¨æˆ·çš„è¯„åˆ†å¯èƒ½ä¼šå—ä»–ä¿¡ä»»çš„ç”¨æˆ·çš„å½±å“ï¼Œå¹¶ä¸”ä»–çš„è¯„åˆ†åŒæ ·ä¼šå½±å“å…¶ä»–ä¿¡ä»»ä»–çš„ç”¨æˆ·ã€‚
ä¸ºäº†å¯¹è¿™ç§æ€æƒ³è¿›è¡Œå»ºæ¨¡ï¼Œä½œè€…æå‡ºï¼Œç”¨æˆ·ä¹‹é—´çš„ä¿¡ä»»å…³ç³»ï¼Œå¯ä»¥æ˜ å°„åˆ°å‘é‡ç©ºé—´ä¹‹ä¸­ï¼Œæ¯ä¸ªç”¨æˆ·ç”¨ä¸¤ä¸ªå‘é‡æ¥è¡¨ç¤ºè¿™ç§å…³ç³»ï¼Œåˆ†åˆ«ä¸ºtrusterå‘é‡å’Œtrusteeå‘é‡,
ç”¨æˆ·Aå¯¹ç”¨æˆ·Bçš„ä¿¡ä»»ç¨‹åº¦ä¸ºwï¼Œå¯ä»¥ç”¨ç”¨æˆ·Açš„trusterå‘é‡ä¸ç”¨æˆ·Bçš„trusteeå‘é‡å†…ç§¯å¾—åˆ°ã€‚

ä¼ ç»ŸCFçŸ©é˜µåˆ†è§£çš„æ–¹æ³•æ˜¯è®¤ä¸ºè¯„åˆ†çŸ©é˜µR ç”±ç”¨æˆ·å› å­ç©ºé—´U å’Œ ç‰©å“å› å­ç©ºé—´Vï¼ˆæœ¬æ–‡ä½¿ç”¨è¿™ç§ç¬¦å·ï¼‰ç›¸ä¹˜å¾—åˆ°ï¼Œ

é€šè¿‡æœ€å°åŒ–ä¸‹é¢çš„æŸå¤±å‡½æ•°ç”± R å¾—åˆ° U Vï¼š

![1](../images/alg/social/trustmf/t1.png)

åŒæ ·åœ°ï¼Œä¿¡ä»»çŸ©é˜µTï¼ˆT<sub>i,j</sub> ä»£è¡¨ç”¨æˆ·i å¯¹ç”¨æˆ·j çš„ä¿¡ä»»å€¼ï¼Œå› ä¸ºç”¨æˆ·j å¯èƒ½å¯¹ç”¨æˆ·i çš„ä¿¡ä»»å€¼ä¸åŒï¼Œå› æ­¤ï¼ŒçŸ©é˜µT ä¸æ˜¯å¯¹ç§°çš„ï¼‰å¯ä»¥ç”± ç”¨æˆ·ä¿¡ä»»çŸ©é˜µ B å’Œ ç”¨æˆ·è¢«ä¿¡ä»»çŸ©é˜µ W
ç›¸ä¹˜å¾—åˆ°ã€‚

é€šè¿‡æœ€å°åŒ–ä¸‹é¢çš„æŸå¤±å‡½æ•°ï¼š

![2](../images/alg/social/trustmf/t2.png)

è¿™ç¯‡æ–‡ç« æå‡ºäº†ä¸‰ä¸ªæ¨¡å‹ï¼šTruster Model, Trustee Model, Truster-MFï¼Œæ¥ç»“åˆä¸Šè¿°çš„ä¸¤ä¸ªçŸ©é˜µåˆ†è§£ã€‚

#### Truster Model

æ ¸å¿ƒæ€æƒ³æ˜¯ ç”¨çŸ©é˜µ B ç»“åˆ ç”¨æˆ·å› å­çŸ©é˜µ U å’Œ ä¿¡ä»»çŸ©é˜µB ï¼Œä»è€ŒæŠŠä¸¤ä¸ªçŸ©é˜µåˆ†è§£é—®é¢˜è”ç³»åœ¨ä¸€èµ·ã€‚R ç”±å› å­ç©ºé—´B(åŒæ—¶åŒ…å«ç”¨æˆ·ä¿¡æ¯å› å­å’Œç”¨æˆ·ä¿¡ä»»ä¿¡æ¯å› å­) å’Œ ç‰©å“å› å­ç©ºé—´V ç›¸ä¹˜å¾—åˆ°ï¼Œ
ä¿¡ä»»çŸ©é˜µT ç”± ç”¨æˆ·ä¿¡ä»»çŸ©é˜µ Bï¼ˆåŒæ—¶åŒ…å«ç”¨æˆ·ä¿¡æ¯å› å­å’Œç”¨æˆ·ä¿¡ä»»ä¿¡æ¯å› å­ï¼‰ å’Œ ç”¨æˆ·è¢«ä¿¡ä»»çŸ©é˜µ W ç›¸ä¹˜å¾—åˆ°ã€‚
é€šè¿‡æœ€å°åŒ–ä¸‹é¢çš„æŸå¤±ï¼Œå¾—åˆ° B V Wï¼š

![3](../images/alg/social/trustmf/t3.png)

å› ä¸ºä¿¡ä»»çŸ©é˜µTçš„å–å€¼åœ¨[0,1]ä¹‹é—´ï¼Œä¸ºäº†æ›´å¥½åœ°å­¦ä¹ æ¨¡å‹ï¼Œè¿™ç¯‡æ–‡ç« æŠŠRåšäº†æ­£åˆ™åŒ–å¤„ç†ï¼Œä¹Ÿé™åˆ¶åœ¨äº†[0,1]ä¹‹é—´ï¼Œæœ¬æ–‡æ²¡æœ‰é‡‡å–çº¿æ€§æ”¾ç¼©ï¼Œè€Œæ˜¯é‡‡å–äº†logistic function(ä¹Ÿå…·æœ‰ä¿è¯åœ¨[0,1]ä¹‹é—´çš„æ€§è´¨)(ä¸‹å¼ä¸­çš„g)ï¼Œå› æ­¤æœ€å°åŒ–æŸå¤±æ¨¡å‹å˜ä¸ºï¼š

![4](../images/alg/social/trustmf/t4.png)

#### Trustee Model

æ€æƒ³ä¸Truster Model ç›¸åŒï¼Œåªä¸è¿‡Wå–ä»£äº†Båœ¨ä¸Šè¿°æ¨¡å‹çš„ä½ç½®ï¼Œæœ€å°åŒ–ä¸‹é¢çš„æŸå¤±ï¼š

![5](../images/alg/social/trustmf/t5.png)


#### Truster-MF

æ˜¯ä¸Šè¿°ä¸¤ç§æ¨¡å‹çš„ç»“åˆï¼Œå…ˆç‹¬ç«‹è®­ç»ƒä¸Šè¿°ä¸¤ä¸ªæ¨¡å‹ï¼Œç„¶åæŒ‰ç…§ä¸‹è¿°å…¬å¼è¿›è¡Œç»“åˆï¼›

![6](../images/alg/social/trustmf/t6.png)

æ€»ç»“ï¼š

è¿™ä¸ªæ¨¡å‹å¯ä»¥ä»ç”¨æˆ·çš„ç¤¾ä¼šè¡Œä¸ºå­¦ä¹ ç”¨æˆ·çš„åå¥½ï¼ˆä¸åªæ˜¯ä»è¯„åˆ†è¡Œä¸ºï¼‰ï¼ŒTruster Modelå­¦åˆ°äº†ï¼Œç”¨æˆ·åœ¨è¯„åˆ†æ˜¯å—åˆ«äººçš„å½±å“ï¼ŒTrustee Modelå­¦åˆ°äº†ï¼Œç”¨æˆ·çš„è¯„åˆ†å¯¹åˆ«äººçš„å½±å“ï¼ŒTruster-MFæŠŠä¸¤è€…ç»“åˆï¼Œè¯•å›¾ç»™ä¸¤ä¸ªç”¨æˆ·ç¾¤éƒ½æä¾›é«˜è´¨é‡çš„æ¨èã€‚

librecæä¾›äº†è¿™ä¸‰ç§æ¨¡å‹çš„é€‰æ‹©ï¼Œåœ¨predict()å‡½æ•°ä¸­å¯ä»¥æ¸…æ¥šçš„çœ‹åˆ°ï¼š

```java
    switch (model) {
        case "Tr":
            predictRating = DenseMatrix.rowMult(trusterUserTrusterFactors, userIdx, trusterItemFactors, itemIdx);
            break;
        case "Te":
            predictRating = DenseMatrix.rowMult(trusteeUserTrusteeFactors, userIdx, trusteeItemFactors, itemIdx);
            break;
        case "T":
        default:
            DenseVector userVector = trusterUserTrusterFactors.row(userIdx).add(trusteeUserTrusteeFactors.row(userIdx, false));
            DenseVector itemVector = trusterItemFactors.row(itemIdx).add(trusteeItemFactors.row(itemIdx, false));
            predictRating = userVector.inner(itemVector) / 4;
    }
```

åœ¨ä»£ç ä¸­å¯ä»¥æ¸…æ™°çœ‹åˆ°ï¼ŒTruster-MFæ¨¡å‹æ˜¯ç‹¬ç«‹è®­ç»ƒä¸¤ä¸ªæ¨¡å‹

```java
    protected void trainModel() throws LibrecException {
        switch (model) {
            case "Tr":
                TrusterMF();
                break;
            case "Te":
                TrusteeMF();
                break;
            case "T":
            default:
                TrusterMF();
                TrusteeMF();
        }
    }
```

### TrustSVDRecommender

å‚è€ƒè®ºæ–‡ï¼š[Guo G, Zhang J, Yorke-Smith N. TrustSVD: Collaborative Filtering with Both the Explicit and Implicit Influence of User Trust and of Item Ratings[C]//Aaai 2015
](https://pdfs.semanticscholar.org/5d29/fd7fdd1323b07a7f6b178253511f0638c998.pdf)

æœ¬æ–‡åœ¨SVD++ çš„åŸºç¡€ä¸Šï¼Œè®¤ä¸ºSocial Trustä¿¡æ¯ä¹Ÿå¯ä»¥åƒSVD++ ä¸€æ ·ï¼ŒæŠŠä¿¡ä»»ä¿¡æ¯çš„æ˜¾å¼ä¿¡æ¯å’Œéšå¼ä¿¡æ¯åŠ å…¥åˆ°æ¨¡å‹ä¸­ã€‚åŒæ ·ä¸ºäº†æ›´å¥½çš„è§£å†³CFçš„ä¸¤å¤§é—®é¢˜ï¼šç¨€ç–æ€§å’Œå†·å¯åŠ¨ã€‚

ä½œè€…é€šè¿‡è§‚å¯Ÿå‡ ä¸ªå¸¦æœ‰Social Trustçš„æ•°æ®é›†ï¼Œå¾—åˆ°äº†ä¸¤ä¸ªè§‚å¯Ÿç»“è®º

![7](../images/alg/social/trustsvd/t1.png)

è§‚å¯Ÿä¸€ï¼šä¿¡ä»»ä¿¡æ¯éå¸¸ç¨€ç–ï¼Œåº”å½“ä½œä¸ºè¯„åˆ†ä¿¡æ¯çš„è¡¥å……

è§‚å¯ŸäºŒï¼šç”¨æˆ·çš„è¯„åˆ†å’Œä»–çš„social neighborçš„å¹³å‡è¯„åˆ†åœ¨åŸºäº trust-alike å…³ç³»çš„åŸºç¡€ä¸‹å…·æœ‰å¼±æ­£ç›¸å…³æ€§ï¼Œåœ¨åŸºäº trust å…³ç³»çš„åŸºç¡€ä¸‹å…·æœ‰å¼ºæ­£ç›¸å…³æ€§

ä»€ä¹ˆæ˜¯trust-alike å…³ç³»ï¼Œåœ¨ FilmTrust å’Œ Flixster è¿™ä¸¤ä¸ªæ•°æ®é›†ï¼Œä¿¡ä»»å…³ç³»ä¸æ˜¯ç‰¹åˆ«æ˜ç¡®ï¼Œæˆ–è€…è¯´æ¯” Trust å…³ç³»æ›´å¼±ï¼ˆæ›´noisyï¼‰
ä½œè€…å®šä¹‰è¿™ç§ä¸æ˜¯å¾ˆå¼ºçš„ä¿¡ä»»å…³ç³»ä¸ºTrust-alike å…³ç³»ã€‚è¿™ä¸¤ä¸ªæ•°æ®çš„ç”¨æˆ·è¯„åˆ†å’Œä»–çš„Social neighborè¯„åˆ†ä¹‹é—´çš„å…³ç³»å‡åˆ†åˆ†åˆ«ä¸º0.183å’Œ
0.063å‘ˆç°å¼±ç›¸å…³æ€§ï¼Œè€Œå¦å¤–ä¸¤ä¸ªæ•°æ®é›†åˆ†åˆ«ä¸º0.446å’Œ0.322ï¼Œå‘ˆç°å¼ºç›¸å…³æ€§ï¼Œç”±æ­¤å¾—åˆ°è¿™ä¸ªç»“è®ºã€‚

å—SVD++æ¨¡å‹å¯å‘ï¼Œä½œè€…åœ¨æ¨¡å‹ä¸­ï¼ŒæŠŠtrust-alikeä¿¡æ¯å½“ä½œéšå¼ä¿¡æ¯ï¼Œå½¢å¼å’ŒSVD++ç›¸åŒï¼š

![8](../images/alg/social/trustsvd/t2.png)

è¿™é‡Œçš„W<sub>v</sub> æ˜¯å¯¹ç‰¹å®šç”¨æˆ·v,ä»–è¢«ç”¨æˆ·uä¿¡ä»»çš„éšå› å­å‘é‡ï¼ˆtrusteeï¼‰ã€‚

é™¤äº†éšå¼ä¿¡æ¯ï¼Œæ˜¾ç¤ºä¿¡æ¯å½¢å¼å’Œç”¨æˆ·çš„å› å­ç©ºé—´å…±äº«å› å­ç©ºé—´ï¼Œä»è€Œæ¶èµ·ä¸¤ä¸ªçŸ©é˜µä¿¡æ¯ç»“åˆçš„æ¡¥æ¢ï¼Œå½¢å¼ä¸å˜ï¼Œåªæ˜¯åœ¨è®­ç»ƒæ—¶ç”¨åˆ°ä¸¤ä¸ªçŸ©é˜µä¿¡æ¯è”åˆè®­ç»ƒã€‚
t<sub>u,v</sub>_hat =W<sub>v</sub><sup>T</sup> * p<sub>u</sub>å¾—åˆ°ã€‚ 

å¦å¤–,ä¸€ç§weighted-ğ›Œ-regularizationçš„æ–¹æ³•èƒ½æ›´æœ‰æ•ˆé˜²æ­¢å‚æ•°è¿‡æ‹Ÿåˆï¼Œæœ€å°åŒ–æŸå¤±æ–¹ç¨‹ä¸ºï¼›

![9](../images/alg/social/trustsvd/t3.png)

å‚æ•°æ›´æ–°ï¼›

![10](../images/alg/social/trustsvd/t4.png)












